---
title: A damn near perfect webpack and hubspot setup (part one)
image: ./thumb-2.png
imageAlt: Webpack Icon
description: An up-to-date webpack config that works in Hubspot
tags: ["hubspot", "react", "html", "scss", "webpack", "babel", "javascript"]
---

<ul class='parts-list'>
  <li>
    <b>Part 1:</b> Hubspot CMS Boilerplate and Webpack setup [YOU ARE HERE]
  </li>
  <li>
    <b>Part 2:</b> BabelJS and lint your way forward [NEXT]
  </li>
  <li>
    <b>Part 3:</b> SCSS and image optimization [WAITING]
  </li>
  <li>
    <b>Part 4:</b> Critical CSS path [WAITING]
  </li>
</ul>

<p>
  If you want just want to copy a minimal webpack.config.js file jump to the{" "}
  <a href='https://github.com/emptypockets-dev/hubspot-with-webpack'>
    Github repo
  </a>
  .
</p>

-

<h2>Part One</h2>
<h3>Just the basics</h3>
<p>
  The rest of this post assumes you are comfortable working with Hubspot and
  probably use npm all the time. Make sure you have the latest version of the
  Hubspot CLI installed.
</p>

```
npm install -g @hubspot/cli@latest
```

-

<h3>Just the boilerplate</h3>
<p>
  Use the Hubspot CLI to create a new website theme in a local folder. Switch to
  the
  <a href='https://github.com/HubSpot/cms-theme-boilerplate'>
    &nbsp;Hubspot docs
  </a> if you get stuck at this point.
</p>
<p>
  <em>Note</em>: don't fetch an existing project. Build a new, basic setup and
  then apply bits of it to your other projects.
</p>

```
hs create website-theme <cool-project-name>
```

<p>
  Configure your project for local development by running `hs-init` in Terminal.
  Follow the written instructions (copy + paste your key).
</p>

```
    hs init
```

<p>
  While you're at it, you'll eventually need a package.json fileâ€”now is a good
  time to run `npm init` to create one:
</p>

```
    npm init
```

<p>Initializing a git repo is always a good idea too.</p>

```
    git init
```

-

<h3>Just the dependencies</h3>

```js
npm install --save-dev webpack webpack-cli copy-webpack-plugin @hubspot/webpack-cms-plugins
```

<ul class='parts-list'>
  <li>[x] webpack</li>
  <li>[x] webpack-cli</li>
  <li>[x] copy-webpack-plugin</li>
  <li>[x] @hubspot/webpack-cms-plugins</li>
</ul>

-

<h3>Just a webpack config file</h3>
<p>
  Hubspot provides an&nbsp;
  <a href='https://www.npmjs.com/package/@hubspot/webpack-cms-plugins'>
    example&nbsp;
  </a>
  but at the moment it needs some tweaks to support Webpack 5 + recent plugin
  updates
</p>

```js
const HubSpotAutoUploadPlugin = require("@hubspot/webpack-cms-plugins/HubSpotAutoUploadPlugin");
const CopyWebpackPlugin = require("copy-webpack-plugin");

module.exports = ({ account, autoupload }) => ({
  entry: "./src/index.js",
  output: {
    filename: "js/main.js",
  },
  plugins: [
    new HubSpotAutoUploadPlugin({
      account,
      autoupload,
      src: "dist",
      dest: "<your-project-folder-in-hubspot-here>",
    }),
    new CopyWebpackPlugin({
      patterns: [
        { from: "src/theme.json", to: "theme.json" },
        { from: "src/fields.json", to: "fields.json" },
        { from: "src/css", to: "css" },
        { from: "src/images", to: "images" },
        { from: "src/modules", to: "modules" },
        { from: "src/templates", to: "templates" },
      ],
    }),
  ],
});
```

<p>You can do a lot more with webpack but this is just a start.</p>

-

<h3>Just a start</h3>
<p>
  Add a "start" script in package.json so that you don't have to keep typing
  webpack --watch --mode etc etc etc.
</p>

```
 "scripts": {
        "start": "webpack --watch --mode development --env account 123 --env autoupload",
    }
```

```
npm start
```

<p>
  Next, a series of amazing things happen. The following might be too much
  information at the moment but understanding each step really helps make
  webpack easy to work with.
</p>

<ul class='parts-list'>
  <li>
    <b>1.</b> Values for "account" and "autoupload" are passed to
    webpack.config.js.
  </li>
  <li>
    <b>2.</b> Webpack starts to build its dependency graph starting from
    ./src/index.js
  </li>
  <li>
    <b>3.</b> Webpack creates a folder named /dist (by default) and outputs code
    into /dist/js/main.js.
  </li>
  <li>
    <b>4.</b> Webpack plugins start to run from the bottom up (in reverse).
  </li>
  <li>
    <b>5.</b> CopyWebpackPlugin copies all /src files into the /dist folder
  </li>
  <li>
    <b>6.</b> HubspotAutouploadPlugin syncs each file that moves through webpack
    into the Hubspot destination folder that you set.
  </li>
  <li>
    <b>7.</b> Webpack watches for changes. It loops through steps 2 through 6
    each time a file is saved.
  </li>
</ul>

-

<h2>Part Two</h2>
<p>
  In part 2, we're going to add Babel to transpile cutting-edge Javascript into
  boring Javascript that browsers understand.
</p>

<h3>Just lint</h3>
